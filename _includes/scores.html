{% comment %}
include.collection
include.filter
include.items
{% endcomment %}


{% if include.collection %}
{% assign collectionItems = site[include.collection] %}
{% endif %}

{% assign items = "" | split: "" %}

{% if include.items %}
{% for item in include.items %}
{% assign siteItem = collectionItems | where:"url", item.url | first %}
{% if siteItem and siteItem.url %}
{% assign items = items | push: siteItem %}
{% else %}
{% assign items = items | push: item %}
{% endif %}
{% endfor %}
{% else %}
{% assign items = collectionItems %}
{% endif %}

{% if include.filter %}
{% assign items = items | where_exp:"item",include.filter %}
{% endif %}

{% assign items = items | sort: "score"|reverse %}

<table>
	<tr>
		<th>#</th>
		{% unless page.collection == "games" %}
		<th>Game</th>
		{% endunless %}
		{% unless page.collection == "players" %}
		<th>Player</th>
		{% endunless %}
		<th>Score</th>
		<th>Platform</th>
		<th>Method</th>
		<th>Date</th>
	</tr>
	{% for score in items %}
	<tr {% if score.url %}onclick="window.location.href='{{score.url}}';" style="cursor: pointer;"{%endif %}>
		
			<td>
				{% if score.url %}<a href="{{ score.url }}">{% endif %}
				{{ forloop.index }}
				{% if score.url %}</a>{% endif %}
			</td>
			

		{% unless page.collection == "games" %}
		{% assign game = site.games | where:"slug", score.game | first %}
		<td>
			<a {% if game.url %}href="{{game.url}}"{% endif %}>
			{{ game.title | default:score.game}}
			</a>
		</td>
		{% endunless %}
		{% unless page.collection == "players" %}
		{% assign player = site.players | where:"slug", score.author | first %}
		<td>
			<a {% if player.url %}href="{{player.url}}"{% endif %}>
			{{player.title | default:score.author}}
		</a>
		</td>
		{% endunless %}
		<td>
			{% if score.url %}<a href="{{ score.url }}">{% endif %}
			{{score.score}}
			{% if score.url %}</a">{% endif %}
		</td>
		<td>
			{% if score.url %}<a href="{{ score.url }}">{% endif %}
			{{score.platform}}
			{% if score.url %}</a">{% endif %}
		</td>
		<td>
			{% if score.url %}<a href="{{ score.url }}">{% endif %}
			{{score.method}}
			{% if score.url %}</a">{% endif %}
		</td>
		<td>
			{% if score.url %}<a href="{{ score.url }}">{% endif %}
			{{score.date| date:site.date-format}}
			{% if score.url %}</a">{% endif %}
		</td>
	</tr>
	{% endfor %}

</table>